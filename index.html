<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Mini E-commerce Demo</title>
</head>
<body>
<h1>Products</h1>
<ul id="products"></ul>
<h2>Cart</h2>
<pre id="cart"></pre>
<button id="place">Place Order</button>


<script>
const API = 'http://localhost:5000'
let products = []
let cart = []


async function load() {
const r = await fetch(API + '/products')
products = await r.json()
const ul = document.getElementById('products')
ul.innerHTML = ''
products.forEach(p => {
const li = document.createElement('li')
li.innerText = `${p.name} - $${p.price} (stock: ${p.stock})`
const btn = document.createElement('button')
btn.innerText = 'Add'
btn.onclick = () => { cart.push({productId: p.id, quantity:1}); renderCart() }
li.appendChild(btn)
ul.appendChild(li)
})
}
function renderCart(){
document.getElementById('cart').innerText = JSON.stringify(cart, null, 2)
}
document.getElementById('place').onclick = async () => {
if(cart.length===0) return alert('cart empty')
const r = await fetch(API + '/orders', {
method: 'POST', headers: {'Content-Type':'application/json'},
body: JSON.stringify({items: cart})
})
if(!r.ok){ const e = await r.json(); return alert('Error: '+JSON.stringify(e)) }
const data = await r.json()
alert('Order placed: ' + data.id)
cart = []
renderCart()
load()
}
load()
</script>
</body>
</html>
